\documentclass[10pt]{beamer}
\usepackage{ragged2e} % \justifying
\usepackage[export]{adjustbox} % left and right in images
\usepackage{subcaption} % subfigure
\usepackage[none]{hyphenat} % Avoids to go out of margin
\include{mathsym}
\usetheme{metropolis}           % Use metropolis theme
\title{Planning and Executing Humanoid Gaits\\in a World of Stairs}
%\subtitle{Michele Cipriano}
%\date{\today}
\date{}
%\author{Michele Cipriano}
\author{
  \textbf{Candidate:} Michele Cipriano \\
	\textbf{Thesis Advisor:} Prof. Giuseppe Oriolo\\
	January 21, 2020
}
\institute{
	\vspace{-0.4cm}
	\begin{center}
    \includegraphics[scale = 0.5]{figures/SapienzaLogo.pdf}\\
	\end{center}
	Master Degree in Artificial Intelligence and Robotics\\
  Department of Computer, Control and Management
  Engineering\\Sapienza University of Rome
}

% Fontsize of figure smaller than normalsize:
\setbeamerfont{caption}{size=\scriptsize}

\begin{document}
\nocite{*}

\maketitle

\justifying

\begin{frame}{Introduction}
  Abstract. Humanoid Robot Locomotion Problem.
\end{frame}

\begin{frame}{Block Scheme}
	\begin{itemize}
	  \item \texttt{elevation\_mapping}: autonomously build a map $\mathcal{M}_z$
		\item RRT-based footstep planner: generate a footstep sequence $\{\bff^j\}$
		    together with swing foot trajectories $\{\bfp_{\rm swg}^*\}$
		\item variable-height CoM IS-MPC: realize a stable trajectory
		    $\bfp_{\rm CoM}^*$
	\end{itemize}
  \begin{figure}
    \centering
    \includegraphics[width=\textwidth]{figures/BlockScheme.pdf}
    \caption{Block scheme of the approach.}
    \label{fig:block-scheme}
  \end{figure}
\end{frame}

\begin{frame}{Variable Height CoM IS-MPC: 3D Motion Model}
  \begin{columns}[c,onlytextwidth]
	  \column{0.7\textwidth}
      \begin{itemize}
        \item LIP model not suitable for gait generation over uneven terrain
				\item constraint vertical motion such that
			    \begin{equation*}
            \frac{\ddot{z}_c + g}{z_c - z_z} = \omega^2
          \end{equation*}
				\item CoM dynamics become
				  \begin{align*}
					  \ddot{x}_c &= \omega^2 (x_c - x_z)\\
					  \ddot{y}_c &= \omega^2 (y_c - y_z)\\
					  \ddot{z}_c &= \omega^2 (z_c - z_z) - g
				  \end{align*}
			\end{itemize}
		\column{0.3\textwidth}
		  \begin{figure}
        \centering
        \includegraphics[width=\textwidth]{figures/LIPM_robot.pdf}
        \caption{ZMP, CoP and COM are colinear.}
        \label{fig:lipm-robot}
    \end{figure}
	\end{columns}
\end{frame}

\begin{frame}{Variable Height CoM IS-MPC: MPC Formulation}
  \begin{columns}[c,onlytextwidth]
	  \column{0.65\textwidth}
			\begin{itemize}
			  \item constrain ZMP into subregion of polyhedral cone (box)
					\begin{equation*}
%						-\frac{1}{2}
%						\begin{pmatrix}
%							\tilde{d}_x^\text{z} \\
%							\tilde{d}_y^\text{z} \\
%							d_z^\text{z}
%						\end{pmatrix}
%						\le
						R_{k+i}^T
						\begin{pmatrix}
							x_z^{k+i} - x_f^{k+i} \\
							y_z^{k+i} - y_f^{k+i} \\
							z_z^{k+i} - y_f^{k+i}
						\end{pmatrix}
						\le
						\frac{1}{2}
						\begin{pmatrix}
							\tilde{d}_x^\text{z} \\
							\tilde{d}_y^\text{z} \\
							d_z^\text{z}
						\end{pmatrix}
					\end{equation*}
				\item bound CoM wrt ZMP (LIP stability)
					\begin{equation*}
						\frac{1}{\omega}\frac{1-e^{-\delta\omega}}{1-e^{-N\delta\omega}}
							\sum_{i=0}^{N-1} e^{-i\delta\omega} \dot{x}_z^{k+i} =
							x_c^k + \frac{\dot{x}_c^k}{\omega} - x_z^k
					\end{equation*}
			  \item solve QP problem using MPC scheme
			\end{itemize}
		\column{0.35\textwidth}
		  \begin{figure}
				\centering
				\includegraphics[width=\textwidth]{figures/balance3d.pdf}
				\caption{CoP internal to support polygon equivalent to ZMP internal
				    to polyhedral cone.}
				\label{fig:balance3d}
      \end{figure}
	\end{columns}
\end{frame}

\begin{frame}{Variable Height CoM IS-MPC: Experiments}
	\begin{figure}
		\begin{subfigure}{0.40\textwidth}
			\includegraphics[width=\linewidth]
				{figures/experiments/multiple-staircases/downstairs/video/01.png}
			%\caption{Starting position}
		\end{subfigure}\hspace*{0.05cm}%{\fill}
		\begin{subfigure}{0.40\textwidth}
			\includegraphics[width=\linewidth]
				{figures/experiments/multiple-staircases/downstairs/video/02.png}
			%\caption{First step}
		\end{subfigure}
		\begin{subfigure}{0.40\textwidth}
			\includegraphics[width=\linewidth]
				{figures/experiments/multiple-staircases/downstairs/video/03.png}
			%\caption{Second step}
		\end{subfigure}\hspace*{0.05cm}%{\fill}
		\begin{subfigure}{0.40\textwidth}
			\includegraphics[width=\linewidth]
				{figures/experiments/multiple-staircases/downstairs/video/04.png}
			%\caption{Third step}
		\end{subfigure}
		\begin{subfigure}{0.40\textwidth}
			\includegraphics[width=\linewidth]
				{figures/experiments/multiple-staircases/downstairs/video/05.png}
			%\caption{Fourth step}
		\end{subfigure}\hspace*{0.05cm}%{\fill}
		\begin{subfigure}{0.40\textwidth}
			\includegraphics[width=\linewidth]
				{figures/experiments/multiple-staircases/downstairs/video/06.png}
			%\caption{Fifth step}
		\end{subfigure}
		\caption{NAO going down the stairs.}
		%\caption{The figures show the motion of the robot for the scenario
		%		``Multiple Staircases (Downstairs)''. The robot starts on top of the 
		%		stairway (Fig. \ref{fig:exp:ms:down:frame1}), then it places 
		%		each step one in front of the other without colliding with the staircases,
		%		safely reaching ground level. Each staircase has a height of 2 cm.}
	\end{figure}
\end{frame}

\begin{frame}{Variable Height CoM IS-MPC: Experiments}	
	\begin{figure}
		\centering
		%\includegraphics[width=0.5\textwidth]
		%		{figures/experiments/multiple-staircases/downstairs/xy-plot-2cm.pdf}
		\includegraphics[width=0.8\textwidth]
				{figures/experiments/multiple-staircases/downstairs/xz-plot-2cm.pdf}
		\caption{CoM/ZMP plot ($z$-axis).}
		%\caption{The plots show how the CoM and the ZMP vary with respect to the
		%	footsteps in the scenario ``Multiple Staircases (Downstairs)''.
		%	The green boxes represent the footsteps.}
	\end{figure}
\end{frame}

\begin{frame}{RRT-based Footstep Planning}
  Problem Formulation: R1, R2, R3. How the planner works (briefly). NAO's
  catalogue of primitives.

  Experiment: Obstacle Avoidance.
\end{frame}

\begin{frame}{Elevation Map Generation}
  \texttt{elevation\_mapping}, features, how it works (briefly).
  Settings: NAO + Xtion + \textit{World of Stairs}.

  Experiments: Generated Map + Stair Climbing in Unknown Environment.
\end{frame}

\begin{frame}[standout]
  Video
\end{frame}

\begin{frame}{Conclusion}
  Results. Future Works.
\end{frame}

\begin{frame}[standout]
    Q\&A
\end{frame}

\appendix

\begin{frame}{References}
  \bibliography{bibliography}
  \bibliographystyle{ieeetr}
\end{frame}

\end{document}

